<!DOCTYPE html>

<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=3.0, user-scalable=yes">
    <title>üè¶ ÏùÄÌñâÁéã - ÏùÄÌñâ Í≤ΩÏòÅ ÏãúÎÆ¨Î†àÏù¥ÏÖò</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lucide/0.263.1/umd/lucide.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-overflow-scrolling: touch;
        }

```
    :root {
        --vh: 1vh;
    }

    body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        overflow-x: hidden;
        touch-action: manipulation;
        min-height: 100vh;
        zoom: 1; /* Í∏∞Î≥∏ Ï§å Î†àÎ≤® */
    }

    /* Î∞òÏùëÌòï Ïä§ÏºÄÏùºÎßÅ */
    @media (max-width: 480px) {
        body { font-size: 14px; }
    }
    
    @media (min-width: 481px) and (max-width: 768px) {
        body { font-size: 16px; }
    }
    
    @media (min-width: 769px) {
        body { font-size: 18px; }
    }

    /* Ïú†Ìã∏Î¶¨Ìã∞ ÌÅ¥ÎûòÏä§Îì§ */
    .hidden { display: none !important; }
    .fixed { position: fixed; }
    .absolute { position: absolute; }
    .relative { position: relative; }
    .sticky { position: sticky; }
    .inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
    .z-10 { z-index: 10; }
    .z-20 { z-index: 20; }
    .z-30 { z-index: 30; }
    .z-40 { z-index: 40; }
    .z-50 { z-index: 50; }

    .flex { display: flex; }
    .flex-col { flex-direction: column; }
    .items-center { align-items: center; }
    .justify-center { justify-content: center; }
    .justify-between { justify-content: space-between; }
    .gap-2 { gap: 0.5rem; }
    .gap-3 { gap: 0.75rem; }
    .gap-4 { gap: 1rem; }
    .gap-6 { gap: 1.5rem; }

    .w-full { width: 100%; }
    .h-full { height: 100%; }
    .min-h-screen { min-height: 100vh; }
    .max-w-sm { max-width: 24rem; }
    .max-w-md { max-width: 28rem; }
    .max-w-lg { max-width: 32rem; }
    .max-w-4xl { max-width: 56rem; }
    .mx-auto { margin-left: auto; margin-right: auto; }

    .p-2 { padding: 0.5rem; }
    .p-3 { padding: 0.75rem; }
    .p-4 { padding: 1rem; }
    .p-6 { padding: 1.5rem; }
    .px-2 { padding-left: 0.5rem; padding-right: 0.5rem; }
    .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
    .px-4 { padding-left: 1rem; padding-right: 1rem; }
    .px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
    .py-1 { padding-top: 0.25rem; padding-bottom: 0.25rem; }
    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
    .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
    .py-4 { padding-top: 1rem; padding-bottom: 1rem; }

    .mb-2 { margin-bottom: 0.5rem; }
    .mb-3 { margin-bottom: 0.75rem; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-6 { margin-bottom: 1.5rem; }
    .mb-8 { margin-bottom: 2rem; }
    .mt-1 { margin-top: 0.25rem; }
    .mt-2 { margin-top: 0.5rem; }
    .mr-2 { margin-right: 0.5rem; }

    .text-xs { font-size: 0.75rem; }
    .text-sm { font-size: 0.875rem; }
    .text-base { font-size: 1rem; }
    .text-lg { font-size: 1.125rem; }
    .text-xl { font-size: 1.25rem; }
    .text-2xl { font-size: 1.5rem; }
    .text-3xl { font-size: 1.875rem; }
    .text-5xl { font-size: 3rem; }

    .font-bold { font-weight: 700; }
    .font-medium { font-weight: 500; }
    .font-mono { font-family: ui-monospace, SFMono-Regular, monospace; }
    .text-center { text-align: center; }

    /* ÏÉâÏÉÅ ÌÅ¥ÎûòÏä§Îì§ */
    .text-white { color: white; }
    .text-gray-300 { color: #d1d5db; }
    .text-gray-600 { color: #4b5563; }
    .text-gray-700 { color: #374151; }
    .text-gray-800 { color: #1f2937; }
    .text-blue-200 { color: #bfdbfe; }
    .text-blue-300 { color: #93c5fd; }
    .text-blue-600 { color: #2563eb; }
    .text-blue-800 { color: #1e40af; }
    .text-green-300 { color: #86efac; }
    .text-green-400 { color: #4ade80; }
    .text-green-600 { color: #16a34a; }
    .text-red-300 { color: #fca5a5; }
    .text-red-500 { color: #ef4444; }
    .text-red-600 { color: #dc2626; }
    .text-red-800 { color: #991b1b; }
    .text-yellow-300 { color: #fde047; }
    .text-yellow-400 { color: #facc15; }
    .text-yellow-600 { color: #ca8a04; }
    .text-yellow-700 { color: #a16207; }
    .text-yellow-800 { color: #854d0e; }

    /* Î∞∞Í≤ΩÏÉâ ÌÅ¥ÎûòÏä§Îì§ */
    .bg-white { background-color: white; }
    .bg-gray-100 { background-color: #f3f4f6; }
    .bg-gray-400 { background-color: #9ca3af; }
    .bg-gray-500 { background-color: #6b7280; }
    .bg-gray-600 { background-color: #4b5563; }
    .bg-gray-700 { background-color: #374151; }
    .bg-gray-800 { background-color: #1f2937; }
    .bg-gray-900 { background-color: #111827; }
    .bg-blue-50 { background-color: #eff6ff; }
    .bg-blue-100 { background-color: #dbeafe; }
    .bg-blue-600 { background-color: #2563eb; }
    .bg-blue-800 { background-color: #1e40af; }
    .bg-blue-900 { background-color: #1e3a8a; }
    .bg-green-50 { background-color: #f0fdf4; }
    .bg-green-100 { background-color: #dcfce7; }
    .bg-red-50 { background-color: #fef2f2; }
    .bg-red-100 { background-color: #fee2e2; }
    .bg-red-600 { background-color: #dc2626; }
    .bg-yellow-50 { background-color: #fefce8; }
    .bg-yellow-100 { background-color: #fef3c7; }
    .bg-yellow-800 { background-color: #92400e; }

    /* Î≤ÑÌäº Ïä§ÌÉÄÏùº */
    .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        border: none;
        border-radius: 0.5rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.2s;
        text-decoration: none;
    }

    .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .btn:active {
        transform: translateY(0);
    }

    .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
    }

    .btn-primary {
        background-color: #2563eb;
        color: white;
    }

    .btn-primary:hover:not(:disabled) {
        background-color: #1d4ed8;
    }

    .btn-secondary {
        background-color: #6b7280;
        color: white;
    }

    .btn-secondary:hover:not(:disabled) {
        background-color: #4b5563;
    }

    /* Í∑∏ÎùºÎîîÏñ∏Ìä∏ Î∞∞Í≤Ω */
    .bg-gradient-start {
        background: linear-gradient(135deg, #1e3a8a 0%, #7c3aed 50%, #1e40af 100%);
    }

    .bg-gradient-bank {
        background: linear-gradient(180deg, #dbeafe 0%, #bfdbfe 100%);
    }

    .bg-gradient-sunset {
        background: linear-gradient(180deg, #fed7aa 0%, #fdba74 100%);
    }

    /* ÏûÖÎ†• ÏöîÏÜå */
    .input {
        width: 100%;
        padding: 0.75rem 1rem;
        border: 2px solid #d1d5db;
        border-radius: 0.5rem;
        font-size: 1rem;
        transition: border-color 0.2s;
    }

    .input:focus {
        outline: none;
        border-color: #2563eb;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    /* Ïä¨ÎùºÏù¥Îçî */
    .slider {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: 1.5rem;
        border-radius: 0.5rem;
        outline: none;
        cursor: pointer;
        background: #d1d5db;
    }

    .slider::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        height: 2rem;
        width: 2rem;
        border-radius: 50%;
        background: #2563eb;
        cursor: pointer;
        border: 3px solid #1e40af;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        transition: all 0.2s ease;
    }

    .slider::-webkit-slider-thumb:hover {
        background: #1d4ed8;
        transform: scale(1.1);
    }

    .slider::-moz-range-thumb {
        height: 2rem;
        width: 2rem;
        border-radius: 50%;
        background: #2563eb;
        cursor: pointer;
        border: 3px solid #1e40af;
        box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }

    /* Ïπ¥Îìú Ïä§ÌÉÄÏùº */
    .card {
        background: white;
        border-radius: 0.5rem;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        padding: 1rem;
    }

    /* Í≤ΩÍ≥† Ïä§ÌÉÄÏùº */
    .alert {
        padding: 1rem;
        border-radius: 0.5rem;
        border-left: 4px solid;
    }

    .alert-warning {
        background-color: #fef3c7;
        border-color: #f59e0b;
        color: #92400e;
    }

    .alert-danger {
        background-color: #fee2e2;
        border-color: #ef4444;
        color: #991b1b;
    }

    /* Ïï†ÎãàÎ©îÏù¥ÏÖò */
    @keyframes pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.5; }
    }

    @keyframes bounce {
        0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
        40%, 43% { transform: translate3d(0, -30px, 0); }
        70% { transform: translate3d(0, -15px, 0); }
        90% { transform: translate3d(0, -4px, 0); }
    }

    .animate-pulse { animation: pulse 2s infinite; }
    .animate-bounce { animation: bounce 1s infinite; }

    /* Í∑∏Î¶¨Îìú */
    .grid { display: grid; }
    .grid-cols-1 { grid-template-columns: repeat(1, 1fr); }
    .grid-cols-2 { grid-template-columns: repeat(2, 1fr); }
    .grid-cols-3 { grid-template-columns: repeat(3, 1fr); }

    /* ÌÖåÎëêÎ¶¨ */
    .border { border: 1px solid #d1d5db; }
    .border-2 { border: 2px solid #d1d5db; }
    .border-4 { border: 4px solid #d1d5db; }
    .border-gray-300 { border-color: #d1d5db; }
    .border-gray-500 { border-color: #6b7280; }
    .border-gray-600 { border-color: #4b5563; }
    .border-blue-400 { border-color: #60a5fa; }
    .border-blue-600 { border-color: #2563eb; }
    .border-yellow-600 { border-color: #ca8a04; }
    .border-yellow-900 { border-color: #713f12; }
    .border-red-500 { border-color: #ef4444; }
    .border-green-400 { border-color: #4ade80; }
    .border-red-400 { border-color: #f87171; }

    .rounded { border-radius: 0.25rem; }
    .rounded-lg { border-radius: 0.5rem; }
    .rounded-xl { border-radius: 0.75rem; }
    .rounded-full { border-radius: 50%; }
    .rounded-t-lg { border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem; }

    /* Í∑∏Î¶ºÏûê */
    .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
    .shadow-xl { box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }

    /* Î≥ÄÌôò */
    .transform { transform: translateZ(0); }
    .translate-x-1\/2 { transform: translateX(50%); }
    .-translate-x-1\/2 { transform: translateX(-50%); }
    .translate-y-1\/2 { transform: translateY(50%); }
    .-translate-y-1\/2 { transform: translateY(-50%); }
    .-translate-y-full { transform: translateY(-100%); }

    /* Í≥†Ï†ï ÏúÑÏπò */
    .top-0 { top: 0; }
    .top-1 { top: 0.25rem; }
    .top-2 { top: 0.5rem; }
    .top-4 { top: 1rem; }
    .top-12 { top: 3rem; }
    .top-16 { top: 4rem; }
    .bottom-0 { bottom: 0; }
    .bottom-1 { bottom: 0.25rem; }
    .bottom-3 { bottom: 0.75rem; }
    .bottom-5 { bottom: 1.25rem; }
    .bottom-6 { bottom: 1.5rem; }
    .bottom-12 { bottom: 3rem; }
    .left-0 { left: 0; }
    .left-1 { left: 0.25rem; }
    .left-2 { left: 0.5rem; }
    .left-4 { left: 1rem; }
    .left-1\/2 { left: 50%; }
    .right-1 { right: 0.25rem; }
    .right-2 { right: 0.5rem; }

    /* ÎÑàÎπÑ/ÎÜíÏù¥ */
    .w-2 { width: 0.5rem; }
    .w-12 { width: 3rem; }
    .w-16 { width: 4rem; }
    .h-2 { height: 0.5rem; }
    .h-6 { height: 1.5rem; }
    .h-8 { height: 2rem; }
    .h-10 { height: 2.5rem; }
    .h-40 { height: 10rem; }
    .h-56 { height: 14rem; }

    /* Í≥µÍ∞Ñ */
    .space-y-1 > * + * { margin-top: 0.25rem; }
    .space-y-2 > * + * { margin-top: 0.5rem; }
    .space-y-4 > * + * { margin-top: 1rem; }

    /* Ïò§Î≤ÑÌîåÎ°úÏö∞ */
    .overflow-hidden { overflow: hidden; }
    .overflow-y-auto { overflow-y: auto; }
    .overflow-x-auto { overflow-x: auto; }

    /* Î™®Î∞îÏùº ÎåÄÏùë */
    @media (max-width: 768px) {
        .mobile\:text-xs { font-size: 0.75rem; }
        .mobile\:text-sm { font-size: 0.875rem; }
        .mobile\:text-base { font-size: 1rem; }
        .mobile\:text-lg { font-size: 1.125rem; }
        .mobile\:text-3xl { font-size: 1.875rem; }
        .mobile\:p-2 { padding: 0.5rem; }
        .mobile\:p-3 { padding: 0.75rem; }
        .mobile\:py-4 { padding-top: 1rem; padding-bottom: 1rem; }
        .mobile\:px-6 { padding-left: 1.5rem; padding-right: 1.5rem; }
        .mobile\:w-full { width: 100%; }
        .mobile\:max-w-sm { max-width: 24rem; }
        .mobile\:grid-cols-1 { grid-template-columns: repeat(1, 1fr); }
        .mobile\:gap-3 { gap: 0.75rem; }
        .mobile\:space-y-2 > * + * { margin-top: 0.5rem; }
        .mobile\:h-40 { height: 10rem; }
        .mobile\:h-8 { height: 2rem; }
        .mobile\:w-12 { width: 3rem; }
        .mobile\:gap-3 { gap: 0.75rem; }
        .mobile\:bottom-6 { bottom: 1.5rem; }
        .mobile\:bottom-3 { bottom: 0.75rem; }
        .mobile\:top-1 { top: 0.25rem; }
        .mobile\:top-12 { top: 3rem; }
        .mobile\:left-2 { left: 0.5rem; }
        .mobile\:right-1 { right: 0.25rem; }
        .mobile\:text-sm { font-size: 0.875rem; }
        
        .slider::-webkit-slider-thumb {
            height: 2rem;
            width: 2rem;
        }
    }

    /* Ï†ÑÌôò Ìö®Í≥º */
    .transition-all { transition: all 0.3s; }
    .transition-colors { transition: color 0.3s, background-color 0.3s; }

    /* Ïª§ÏÑú */
    .cursor-pointer { cursor: pointer; }
    .cursor-not-allowed { cursor: not-allowed; }

    /* Ìà¨Î™ÖÎèÑ */
    .bg-opacity-75 { background-color: rgba(0, 0, 0, 0.75); }

    /* ÏµúÎåÄ ÎÜíÏù¥ */
    .max-h-screen { max-height: 100vh; }

    /* ÌîåÎ†âÏä§ Í¥ÄÎ†® */
    .flex-1 { flex: 1; }
    .flex-shrink-0 { flex-shrink: 0; }

    /* ÏïàÏ†Ñ ÏòÅÏó≠ ÎåÄÏùë */
    @supports (padding: max(0px)) {
        .safe-area-top {
            padding-top: max(1rem, env(safe-area-inset-top));
        }
        
        .safe-area-bottom {
            padding-bottom: max(1rem, env(safe-area-inset-bottom));
        }
    }
</style>
```

</head>
<body>
    <div id="app"></div>

```
<script>
    // Í≤åÏûÑ ÏÉÅÌÉú
    let gameState = {
        bankName: "",
        initialCapital: 50000000000,
        currentCapital: 50000000000,
        totalProfit: 0,
        depositRate: 2.5,
        depositCustomers: 100,
        avgDepositAmount: 50000000,
        totalDepositBalance: 5000000000,
        assetYield: 3.5,
        loanRate: 5.0,
        loanCustomers: 50,
        avgLoanAmount: 100000000,
        totalLoanBalance: 5000000000,
        defaultRate: 0.05,
        advertising: 1000000,
        round: 1,
        year: 1,
        month: 1,
        currentTime: 9,
        isBusinessHours: true,
        dayEnded: false,
        baseRate: 3.5,
        gameStarted: false,
        fscWarnings: [],
        fscWatchList: false,
        boardPressure: 0
    };

    // UI ÏÉÅÌÉú
    let uiState = {
        isMobile: false,
        orientation: 'portrait',
        currentEvent: null,
        marketReactions: [],
        showDayEndPopup: false,
        customers: [],
        tellerBusy: [false, false, false],
        dayResults: null,
        showInputModal: false,
        inputType: '',
        inputValue: '',
        inputLabel: ''
    };

    // ÌÉÄÏù¥Î®∏Îì§
    let gameTimer = null;
    let customerTimer = null;

    // Î™®Î∞îÏùº Í∞êÏßÄ
    function checkMobile() {
        const mobile = window.innerWidth < 768;
        const newOrientation = window.innerHeight > window.innerWidth ? 'portrait' : 'landscape';
        uiState.isMobile = mobile;
        uiState.orientation = newOrientation;
        
        // Î∑∞Ìè¨Ìä∏ ÎÜíÏù¥ ÏÑ§Ï†ï
        const vh = window.innerHeight * 0.01;
        document.documentElement.style.setProperty('--vh', `${vh}px`);
    }

    // ÏßÑÎèô ÌîºÎìúÎ∞±
    function vibrate(duration = 50) {
        if (navigator.vibrate) {
            navigator.vibrate(duration);
        }
    }

    // ÌÜµÌôî Ìè¨Îß∑ÌåÖ
    function formatCurrency(amount) {
        if (amount >= 1000000000000) {
            return `${(amount / 1000000000000).toFixed(1)}Ï°∞Ïõê`;
        } else if (amount >= 100000000) {
            return `${(amount / 100000000).toFixed(0)}ÏñµÏõê`;
        } else if (amount >= 10000) {
            return `${(amount / 10000).toFixed(0)}ÎßåÏõê`;
        }
        return new Intl.NumberFormat('ko-KR', {
            style: 'currency',
            currency: 'KRW',
            maximumFractionDigits: 0
        }).format(amount);
    }

    // ÏãúÍ∞Ñ Ìè¨Îß∑ÌåÖ
    function formatTime(time) {
        const hour = Math.floor(time);
        const minute = Math.round((time % 1) * 60);
        return `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
    }

    // ÏãúÏû• Ïù¥Î≤§Ìä∏
    const marketEvents = [
        { name: "Í≤ΩÍ∏∞ Ìò∏Ìô©", effect: "Í≥†Í∞ù Ïàò +25%, Ïö¥Ïö©ÏàòÏùµ +0.5%p", multiplier: 1.25, yieldBonus: 0.5, defaultChange: -0.3 },
        { name: "Í≤ΩÍ∏∞ Ïπ®Ï≤¥", effect: "Í≥†Í∞ù Ïàò -20%, Ïö¥Ïö©ÏàòÏùµ -0.3%p", multiplier: 0.8, yieldBonus: -0.3, defaultChange: 0.6 },
        { name: "Í∏àÎ¶¨ Ïù∏ÏÉÅ", effect: "ÏòàÍ∏à Í≥†Í∞ù +20%, ÎåÄÏ∂ú Í≥†Í∞ù -15%", depositMultiplier: 1.2, loanMultiplier: 0.85, defaultChange: 0.2 },
        { name: "Î∂ÄÎèôÏÇ∞ Ìò∏Ìô©", effect: "ÎåÄÏ∂ú ÏàòÏöî Í∏âÏ¶ù +40%", loanMultiplier: 1.4, defaultChange: -0.1 },
        { name: "ÏïàÏ†ïÏ†Å ÏãúÏû•", effect: "Î≥ÄÌôî ÏóÜÏùå", multiplier: 1.0, defaultChange: 0 }
    ];

    // ÏãúÏû• Î∞òÏùë ÏÉùÏÑ±
    function generateMarketReactions(depositRate, loanRate, bankName) {
        const reactions = [];

        if (depositRate >= 3.3) {
            reactions.push({
                type: 'positive',
                icon: 'üòä',
                message: `"${bankName} ÏòàÍ∏à Ïù¥ÏûêÍ∞Ä ${depositRate}%ÎùºÎãà! Îèà Îß°Í∏∞Îü¨ Í∞ëÎãàÎã§! üí∞"`
            });
        } else if (depositRate < 2.3) {
            reactions.push({
                type: 'negative',
                icon: 'üòû',
                message: `"ÏòàÍ∏à Ïù¥Ïûê ${depositRate}%Îäî ÎÑàÎ¨¥ ÎÇÆÏïÑÏöî... Îã§Î•∏ ÏùÄÌñâ ÏïåÏïÑÎ¥êÏïºÍ≤†Ïñ¥Ïöî üò§"`
            });
        }

        if (loanRate <= 4.7) {
            reactions.push({
                type: 'positive',
                icon: 'üéâ',
                message: `"${bankName} ÎåÄÏ∂ú Ïù¥Ïûê ${loanRate}%! ÏßÑÏßú Ï†ÄÎ†¥ÌïòÎÑ§Ïöî! ÎåÄÏ∂ú Î∞õÏúºÎü¨ Í∞ëÎãàÎã§! üèÉ‚Äç‚ôÇÔ∏è"`
            });
        } else if (loanRate > 5.7) {
            reactions.push({
                type: 'negative',
                icon: 'üò§',
                message: `"ÎåÄÏ∂ú Ïù¥Ïûê ${loanRate}%Îäî ÎÑàÎ¨¥ ÎπÑÏã∏Ïöî! Îã§Î•∏ ÏùÄÌñâÏù¥ Îçî Ïã∏ÎçòÎç∞... üí∏"`
            });
        }

        const margin = loanRate - depositRate;
        if (margin > 3.5) {
            reactions.push({
                type: 'negative',
                icon: 'üò†',
                message: `"Ïù¥Ïûê Ï∞®Ïù¥Í∞Ä ${margin.toFixed(1)}%ÎÇò? ÏùÄÌñâÏù¥ ÎÑàÎ¨¥ ÎßéÏù¥ Í∞ÄÏ†∏Í∞ÄÎäî Í±∞ ÏïÑÎãàÏóêÏöî?"`
            });
        } else if (margin < 1.5) {
            reactions.push({
                type: 'positive',
                icon: 'üëè',
                message: `"Ïù¥Ïûê Ï∞®Ïù¥Í∞Ä ${margin.toFixed(1)}%Î∞ñÏóê Ïïà ÎêòÎÑ§! ÏñëÏã¨Ï†ÅÏù∏ ÏùÄÌñâÏù¥ÎÑ§Ïöî!"`
            });
        }

        return reactions;
    }

    // ÌïòÎ£® Í≤∞Í≥º Í≥ÑÏÇ∞
    function calculateDayResults() {
        const event = marketEvents[Math.floor(Math.random() * marketEvents.length)];
        uiState.currentEvent = event;

        const adEffect = Math.min(gameState.advertising / 1000000, 3);

        const baseDepositCustomers = Math.max(10, 
            100 - (gameState.depositRate - 2.8) * (-30) + adEffect * 15
        );
        const newDepositCustomers = Math.floor(baseDepositCustomers * (event.depositMultiplier || event.multiplier || 1));
        const newTotalDepositBalance = newDepositCustomers * gameState.avgDepositAmount;

        const baseLoanCustomers = Math.max(5,
            80 - (gameState.loanRate - 5.2) * 20 + adEffect * 10
        );
        const newLoanCustomers = Math.floor(baseLoanCustomers * (event.loanMultiplier || event.multiplier || 1));
        const newLoanExecuted = newLoanCustomers * gameState.avgLoanAmount;

        const capitalAfterLoan = Math.max(0, gameState.currentCapital - newLoanExecuted);

        const actualLoanExecuted = gameState.currentCapital >= newLoanExecuted ? 
            newLoanExecuted : gameState.currentCapital;
        const actualNewLoanCustomers = actualLoanExecuted / gameState.avgLoanAmount;
        const newTotalLoanBalance = gameState.totalLoanBalance + actualLoanExecuted;

        const adjustedDefaultRate = Math.max(0.01, Math.min(0.25, 
            (gameState.defaultRate + Math.random() * 0.1 - 0.05) * (1 + (event.defaultChange || 0))
        ));

        const depositInterestCost = newTotalDepositBalance * (gameState.depositRate / 100);
        const assetOperationIncome = newTotalDepositBalance * ((gameState.assetYield + (event.yieldBonus || 0)) / 100);
        const loanInterestIncome = newTotalLoanBalance * (gameState.loanRate / 100);
        const defaultLoss = newTotalLoanBalance * adjustedDefaultRate;
        const operatingCost = (gameState.initialCapital * 0.015) + gameState.advertising;

        const netIncome = assetOperationIncome + loanInterestIncome - depositInterestCost - defaultLoss - operatingCost;

        return {
            event,
            depositCustomers: newDepositCustomers,
            totalDepositBalance: newTotalDepositBalance,
            depositInterestCost,
            assetOperationIncome,
            assetYield: gameState.assetYield + (event.yieldBonus || 0),
            loanCustomers: actualNewLoanCustomers,
            newLoanExecuted: actualLoanExecuted,
            totalLoanBalance: newTotalLoanBalance,
            loanInterestIncome,
            defaultLoss,
            defaultRate: adjustedDefaultRate,
            capitalUsed: actualLoanExecuted,
            newCurrentCapital: capitalAfterLoan,
            operatingCost,
            netIncome,
            capitalShortage: newLoanExecuted > gameState.currentCapital
        };
    }

    // ÌïòÎ£® Ï≤òÎ¶¨
    function processDay() {
        const results = calculateDayResults();
        uiState.dayResults = results;

        const nextMonth = gameState.month === 12 ? 1 : gameState.month + 1;
        const nextYear = gameState.month === 12 ? gameState.year + 1 : gameState.year;

        gameState.depositCustomers = results.depositCustomers;
        gameState.loanCustomers = results.loanCustomers;
        gameState.totalDepositBalance = results.totalDepositBalance;
        gameState.totalLoanBalance = results.totalLoanBalance;
        gameState.currentCapital = results.newCurrentCapital;
        gameState.totalProfit += results.netIncome;
        gameState.defaultRate = results.defaultRate;
        gameState.round += 1;
        gameState.month = nextMonth;
        gameState.year = nextYear;
        gameState.currentTime = 9;
        gameState.isBusinessHours = true;
        gameState.dayEnded = false;
        gameState.baseRate += (Math.random() - 0.5) * 0.25;

        uiState.marketReactions = generateMarketReactions(gameState.depositRate, gameState.loanRate, gameState.bankName);
        uiState.showDayEndPopup = false;

        startTimers();
        render();
    }

    // Í≤åÏûÑ ÏãúÏûë (Í∞úÏÑ†Îêú Î≤ÑÏ†Ñ)
    function startGame() {
        console.log('Starting game...');
        gameState.gameStarted = true;
        gameState.totalDepositBalance = gameState.depositCustomers * gameState.avgDepositAmount;
        gameState.totalLoanBalance = gameState.loanCustomers * gameState.avgLoanAmount;
        
        console.log('Game state:', gameState);
        startTimers();
        render();
        console.log('Game started successfully');
    }

    // ÌÉÄÏù¥Î®∏ ÏãúÏûë (Í∞úÏÑ†Îêú Î≤ÑÏ†Ñ)
    function startTimers() {
        clearTimers();
        console.log('Starting timers...', gameState.gameStarted, gameState.isBusinessHours);

        if (gameState.gameStarted && gameState.isBusinessHours) {
            // Í≤åÏûÑ ÏãúÍ∞Ñ ÌÉÄÏù¥Î®∏ (Îçî ÏïàÏ†ïÏ†ÅÏù∏ Î≤ÑÏ†Ñ)
            gameTimer = setInterval(() => {
                try {
                    gameState.currentTime += 0.15;
                    console.log('Time updated:', gameState.currentTime);
                    
                    if (gameState.currentTime >= 18) {
                        gameState.currentTime = 18;
                        gameState.isBusinessHours = false;
                        gameState.dayEnded = true;
                        uiState.showDayEndPopup = true;
                        clearTimers();
                        vibrate(100);
                        console.log('Day ended, showing popup');
                        render(); // Í∞ïÏ†ú Î†åÎçîÎßÅ
                    }
                    
                    updateTimeDisplay();
                } catch (error) {
                    console.error('Game timer error:', error);
                }
            }, 1000);

            // Í≥†Í∞ù Ïï†ÎãàÎ©îÏù¥ÏÖò ÌÉÄÏù¥Î®∏
            customerTimer = setInterval(() => {
                try {
                    if (Math.random() < 0.4) {
                        const newCustomer = {
                            id: Date.now() + Math.random(),
                            type: Math.random() < 0.6 ? 'deposit' : 'loan',
                            position: -100,
                            speed: 2 + Math.random() * 4
                        };
                        
                        uiState.customers = [...uiState.customers.slice(-8), newCustomer];
                    }

                    uiState.customers = uiState.customers.map(customer => ({
                        ...customer,
                        position: customer.position + customer.speed
                    })).filter(customer => customer.position < 600);

                    uiState.tellerBusy = uiState.tellerBusy.map(() => Math.random() < 0.3);

                    updateCustomerAnimation();
                } catch (error) {
                    console.error('Customer timer error:', error);
                }
            }, 300);
            
            console.log('Timers started successfully');
        }
    }

    // ÏàòÎèô ÏãúÍ∞Ñ ÏßÑÌñâ Ìï®Ïàò (ÌÖåÏä§Ìä∏Ïö©)
    function advanceTime() {
        if (gameState.gameStarted && gameState.isBusinessHours) {
            gameState.currentTime += 1; // 1ÏãúÍ∞Ñ ÏßÑÌñâ
            
            if (gameState.currentTime >= 18) {
                gameState.currentTime = 18;
                gameState.isBusinessHours = false;
                gameState.dayEnded = true;
                uiState.showDayEndPopup = true;
                clearTimers();
                vibrate(100);
            }
            
            updateTimeDisplay();
            render();
        }
    }

    // ÌÉÄÏù¥Î®∏ Ï†ïÎ¶¨
    function clearTimers() {
        if (gameTimer) {
            clearInterval(gameTimer);
            gameTimer = null;
        }
        if (customerTimer) {
            clearInterval(customerTimer);
            customerTimer = null;
        }
    }

    // ÏãúÍ∞Ñ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏
    function updateTimeDisplay() {
        const timeEl = document.getElementById('current-time');
        const clockEl = document.getElementById('wall-clock');
        
        if (timeEl) {
            timeEl.textContent = formatTime(gameState.currentTime);
            
            if (gameState.currentTime >= 17.5) {
                timeEl.className = 'font-mono text-red-300 animate-pulse ' + (uiState.isMobile ? 'text-sm' : 'text-lg');
            } else if (gameState.currentTime >= 17) {
                timeEl.className = 'font-mono text-yellow-300 ' + (uiState.isMobile ? 'text-sm' : 'text-lg');
            } else {
                timeEl.className = 'font-mono text-green-300 ' + (uiState.isMobile ? 'text-sm' : 'text-lg');
            }
        }

        if (clockEl) {
            updateWallClock();
        }
    }

    // Î≤ΩÏãúÍ≥Ñ ÏóÖÎç∞Ïù¥Ìä∏ (Í∞úÏÑ†Îêú Î≤ÑÏ†Ñ)
    function updateWallClock() {
        try {
            const hour = gameState.currentTime % 12;
            const minute = (gameState.currentTime % 1) * 60;
            const hourAngle = (hour * 30) + (minute * 0.5);
            const minuteAngle = minute * 6;
            const isClosingSoon = gameState.currentTime >= 17.5;

            const hourHand = document.getElementById('hour-hand');
            const minuteHand = document.getElementById('minute-hand');
            const clockBorder = document.getElementById('clock-border');
            const timeDisplay = document.getElementById('clock-time-display');

            if (hourHand) {
                hourHand.style.transform = `translate(-50%, -100%) rotate(${hourAngle}deg)`;
                hourHand.className = `absolute top-1/2 left-1/2 rounded-full origin-bottom z-20 transition-all duration-1000 ${
                    isClosingSoon ? 'bg-red-600' : 'bg-black'
                }`;
            } else {
                console.warn('Hour hand element not found');
            }

            if (minuteHand) {
                minuteHand.style.transform = `translate(-50%, -100%) rotate(${minuteAngle}deg)`;
                minuteHand.className = `absolute top-1/2 left-1/2 rounded-full origin-bottom z-10 transition-all duration-1000 ${
                    isClosingSoon ? 'bg-red-500' : 'bg-gray-700'
                }`;
            } else {
                console.warn('Minute hand element not found');
            }

            if (clockBorder) {
                clockBorder.className = `bg-white rounded-full border-4 shadow-xl transition-all duration-500 ${
                    isClosingSoon ? 'border-red-500 animate-pulse' : 'border-yellow-600'
                }`;
            } else {
                console.warn('Clock border element not found');
            }

            if (timeDisplay) {
                timeDisplay.textContent = formatTime(gameState.currentTime);
                timeDisplay.className = `mt-1 text-center px-2 py-1 rounded font-mono font-bold text-xs ${
                    isClosingSoon ? 'bg-red-600 text-white animate-pulse' : 'bg-gray-800 text-green-400'
                }`;
            } else {
                console.warn('Time display element not found');
            }
        } catch (error) {
            console.error('Clock update error:', error);
        }
    }

    // Í≥†Í∞ù Ïï†ÎãàÎ©îÏù¥ÏÖò ÏóÖÎç∞Ïù¥Ìä∏
    function updateCustomerAnimation() {
        const customerArea = document.getElementById('customer-area');
        if (!customerArea) return;

        customerArea.innerHTML = '';
        
        uiState.customers.forEach(customer => {
            const customerEl = document.createElement('div');
            customerEl.className = 'absolute transition-all duration-500';
            customerEl.style.left = `${customer.position}px`;
            customerEl.style.bottom = '0px';
            customerEl.style.transform = uiState.isMobile ? 'scale(0.7)' : 'scale(1)';
            
            customerEl.innerHTML = `
                <div class="${uiState.isMobile ? 'text-sm' : 'text-lg'}">
                    ${customer.type === 'deposit' ? 'üë®‚Äçüíº' : 'üë©‚Äçüíº'}
                </div>
                <div class="text-xs text-center bg-white px-1 rounded">
                    ${customer.type === 'deposit' ? 'ÏòàÍ∏à' : 'ÎåÄÏ∂ú'}
                </div>
            `;
            
            customerArea.appendChild(customerEl);
        });

        // Ï∞ΩÍµ¨ ÏßÅÏõê ÏóÖÎç∞Ïù¥Ìä∏
        for (let i = 0; i < 3; i++) {
            const tellerEl = document.getElementById(`teller-${i}`);
            if (tellerEl) {
                tellerEl.className = `absolute left-1/2 transform -translate-x-1/2 transition-all duration-500 ${
                    uiState.isMobile ? '-top-4' : '-top-6'
                } ${uiState.tellerBusy[i] ? 'animate-bounce' : ''}`;
            }
        }
    }

    // ÏûÖÎ†• Î™®Îã¨ Í¥ÄÎ†®
    function openInputModal(type, currentValue, label) {
        uiState.inputType = type;
        uiState.inputValue = currentValue.toString();
        uiState.inputLabel = label;
        uiState.showInputModal = true;
        render();
        
        setTimeout(() => {
            const input = document.getElementById('modal-input');
            if (input) input.focus();
        }, 100);
    }

    function closeInputModal() {
        uiState.showInputModal = false;
        uiState.inputType = '';
        uiState.inputValue = '';
        uiState.inputLabel = '';
        render();
    }

    function applyInputValue() {
        const numValue = parseFloat(uiState.inputValue);
        if (isNaN(numValue)) return;

        let newValue = numValue;

        switch (uiState.inputType) {
            case 'depositRate':
                newValue = Math.max(1, Math.min(5, numValue));
                gameState.depositRate = newValue;
                break;
            case 'loanRate':
                newValue = Math.max(3, Math.min(10, numValue));
                gameState.loanRate = newValue;
                break;
            case 'advertising':
                newValue = Math.max(0, Math.min(5000000, numValue));
                gameState.advertising = Math.round(newValue);
                break;
        }

        closeInputModal();
        vibrate(50);
    }

    // Ïä¨ÎùºÏù¥Îçî ÏÉùÏÑ±
    function createSlider(id, label, value, min, max, step, unit, color, type, description) {
        const formatValue = (val) => {
            if (unit === 'Ïõê') {
                return new Intl.NumberFormat('ko-KR').format(val) + unit;
            }
            return val + unit;
        };

        return `
            <div class="bg-gray-100 p-4 rounded-lg">
                <div class="flex justify-between items-center mb-2">
                    <label class="font-bold text-gray-800 ${uiState.isMobile ? 'text-sm' : 'text-base'}">
                        ${label}
                    </label>
                    <div class="flex items-center gap-2">
                        <span class="font-mono font-bold text-${color}-600 ${uiState.isMobile ? 'text-sm' : 'text-lg'}" id="${id}-value">
                            ${formatValue(value)}
                        </span>
                        <button
                            onclick="openInputModal('${type}', ${value}, '${label}')"
                            class="px-2 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded text-xs font-bold transition-colors ${
                                uiState.isMobile ? 'min-w-[60px]' : ''
                            }"
                        >
                            ÏßÅÏ†ëÏûÖÎ†•
                        </button>
                    </div>
                </div>
                
                <input
                    type="range"
                    id="${id}"
                    min="${min}"
                    max="${max}"
                    step="${step}"
                    value="${value}"
                    class="slider w-full ${uiState.isMobile ? 'h-8' : 'h-6'} rounded-lg cursor-pointer"
                    onchange="updateSliderValue('${id}', '${type}', '${unit}')"
                />
                
                <div class="flex justify-between text-xs text-gray-600 mt-1">
                    <span>${min}${unit}</span>
                    <span>${max}${unit}</span>
                </div>
                
                ${description ? `<p class="text-xs text-gray-600 mt-2">${description}</p>` : ''}
            </div>
        `;
    }

    // Ïä¨ÎùºÏù¥Îçî Í∞í ÏóÖÎç∞Ïù¥Ìä∏
    function updateSliderValue(id, type, unit) {
        const slider = document.getElementById(id);
        const valueDisplay = document.getElementById(id + '-value');
        
        if (!slider || !valueDisplay) return;
        
        const value = parseFloat(slider.value);
        
        switch (type) {
            case 'depositRate':
                gameState.depositRate = value;
                break;
            case 'loanRate':
                gameState.loanRate = value;
                break;
            case 'advertising':
                gameState.advertising = parseInt(value);
                break;
        }
        
        const formatValue = (val) => {
            if (unit === 'Ïõê') {
                return new Intl.NumberFormat('ko-KR').format(val) + unit;
            }
            return val + unit;
        };
        
        valueDisplay.textContent = formatValue(value);
    }

    // Î©îÏù∏ Î†åÎçîÎßÅ Ìï®Ïàò
    function render() {
        const app = document.getElementById('app');
        
        if (!gameState.gameStarted) {
            app.innerHTML = renderStartScreen();
            return;
        }
        
        app.innerHTML = renderGameScreen();
        
        if (uiState.showDayEndPopup) {
            app.insertAdjacentHTML('beforeend', renderDayEndPopup());
        }
        
        if (uiState.showInputModal) {
            app.insertAdjacentHTML('beforeend', renderInputModal());
        }
        
        updateTimeDisplay();
        updateCustomerAnimation();
    }

    // ÏãúÏûë ÌôîÎ©¥ Î†åÎçîÎßÅ
    function renderStartScreen() {
        return `
            <div class="bg-gradient-start p-4 safe-area-top safe-area-bottom" style="min-height: ${uiState.isMobile ? 'calc(var(--vh, 1vh) * 100)' : '100vh'}">
                <div class="${uiState.isMobile ? 'max-w-sm mx-auto' : 'max-w-4xl mx-auto'}">
                    <div class="text-center mb-8">
                        <h1 class="${uiState.isMobile ? 'text-3xl' : 'text-5xl'} font-bold text-white mb-4">üè¶ ÏùÄÌñâÁéã</h1>
                        <p class="${uiState.isMobile ? 'text-lg' : 'text-xl'} text-blue-200">
                            ÌòÑÏã§Ï†ÅÏù∏ ÏùÄÌñâ Í≤ΩÏòÅ ÏãúÎÆ¨Î†àÏù¥ÏÖò
                        </p>
                        <p class="text-blue-300 text-sm mt-2">üí∞ ÏàòÏã†‚ÜíÏö¥Ïö©ÏàòÏùµ | üí∏ Ïó¨Ïã†‚ÜíÏù¥ÏûêÏàòÏùµ</p>
                    </div>

                    <div class="bg-gray-900 border-2 border-blue-400 rounded-xl p-6">
                        <div class="mb-6">
                            <label class="block text-blue-300 font-bold mb-2">üèõÔ∏è ÏùÄÌñâ Ïù¥Î¶Ñ:</label>
                            <input
                                type="text"
                                id="bank-name-input"
                                placeholder="${uiState.isMobile ? 'ÏùÄÌñâ Ïù¥Î¶Ñ ÏûÖÎ†•' : 'Ïòà: Ïã†Ìïú, Íµ≠ÎØº, ÌïòÎÇò, Ïö∞Î¶¨...'}"
                                value="${gameState.bankName}"
                                class="input bg-gray-700 border-gray-600 text-white ${uiState.isMobile ? 'py-4 text-lg' : 'py-3 text-lg'}"
                                onchange="gameState.bankName = this.value; render();"
                            />
                        </div>

                        <div class="bg-gray-800 p-4 rounded-lg mb-6">
                            <h3 class="text-yellow-400 font-bold mb-2">üéØ Í≤åÏûÑ ÌïµÏã¨</h3>
                            <ul class="text-gray-300 text-sm space-y-1">
                                <li>üí∞ <strong>ÏàòÏã†ÏóÖÎ¨¥</strong>: ÏòàÍ∏à Ïú†Ïπò ‚Üí ÏûêÍ∏à Ïö¥Ïö© (2~5% ÏàòÏùµ)</li>
                                <li>üí∏ <strong>Ïó¨Ïã†ÏóÖÎ¨¥</strong>: ÏûêÎ≥∏Í∏àÏúºÎ°ú ÎåÄÏ∂ú ‚Üí Ïù¥Ïûê ÏàòÏùµ</li>
                                <li>üìä <strong>Î™©Ìëú</strong>: Ïù¥Ïûê ÎßàÏßÑ ÏµúÏ†ÅÌôîÎ°ú ÏàòÏùµ Í∑πÎåÄÌôî</li>
                                <li>‚ö†Ô∏è <strong>Î¶¨Ïä§ÌÅ¨</strong>: Ïó∞Ï≤¥ ÏÜêÏã§, ÏûêÎ≥∏Í∏à Í≥†Í∞à Ï£ºÏùò</li>
                            </ul>
                        </div>

                        <button
                            onclick="startGame()"
                            ${gameState.bankName.trim() ? '' : 'disabled'}
                            class="btn ${gameState.bankName.trim() ? 'btn-primary' : 'btn-secondary cursor-not-allowed'} w-full ${uiState.isMobile ? 'py-4 px-6 text-lg' : 'py-4 px-6 text-xl'}"
                        >
                            ${gameState.bankName.trim() ? `üöÄ ${gameState.bankName} ÏùÄÌñâ ÏãúÏûë!` : 'ÏùÄÌñâ Ïù¥Î¶ÑÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî'}
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    // Í≤åÏûÑ ÌôîÎ©¥ Î†åÎçîÎßÅ
    function renderGameScreen() {
        return `
            <div class="min-h-screen bg-gradient-to-b from-blue-100 to-blue-50" style="min-height: ${uiState.isMobile ? 'calc(var(--vh, 1vh) * 100)' : '100vh'}">
                <!-- ÏÉÅÎã® Ï†ïÎ≥¥ Î∞î -->
                <div class="bg-gray-800 text-white sticky top-0 z-40 ${uiState.isMobile ? 'p-2' : 'p-3'} ${uiState.isMobile ? 'text-xs' : 'text-sm'}">
                    <div class="${uiState.isMobile ? 'space-y-2' : 'flex justify-between items-center'}">
                        <div class="${uiState.isMobile ? 'flex flex-wrap items-center gap-2' : 'flex items-center gap-6'}">
                            <h1 class="${uiState.isMobile ? 'text-base' : 'text-xl'} font-bold">üè¶ ${gameState.bankName}</h1>
                            <div class="text-blue-300">
                                üìÖ ${gameState.year}ÎÖÑ ${gameState.month}Ïõî ${gameState.round}Ïùº
                            </div>
                            <div id="current-time" class="font-mono ${uiState.isMobile ? 'text-sm' : 'text-lg'} text-green-300">
                                üïê ${formatTime(gameState.currentTime)}
                            </div>
                        </div>

                        <div class="${uiState.isMobile ? 'flex items-center gap-2 mt-2' : 'flex items-center gap-4'}">
                            <div class="text-green-400 font-bold ${uiState.isMobile ? 'text-sm' : ''}">
                                üí∞ ÏûêÎ≥∏Í∏à: ${formatCurrency(gameState.currentCapital)}
                            </div>
                            ${gameState.isBusinessHours ? `
                                <button 
                                    onclick="advanceTime()" 
                                    class="btn btn-primary px-2 py-1 text-xs"
                                    title="ÏãúÍ∞Ñ ÏßÑÌñâ (ÌÖåÏä§Ìä∏Ïö©)"
                                >
                                    ‚è∞ +1ÏãúÍ∞Ñ
                                </button>
                            ` : `
                                <button 
                                    onclick="uiState.showDayEndPopup = true; render();" 
                                    class="btn btn-primary px-2 py-1 text-xs"
                                    title="ÌïòÎ£® ÎßàÍ∞ê (ÌÖåÏä§Ìä∏Ïö©)"
                                >
                                    üåô ÎßàÍ∞ê
                                </button>
                            `}
                        </div>
                    </div>
                </div>

                <!-- ÏùÄÌñâ Ï∞ΩÍµ¨ Ïï†ÎãàÎ©îÏù¥ÏÖò -->
                <div class="relative overflow-hidden transition-all duration-1000 ${uiState.isMobile ? 'h-40' : 'h-56'} ${gameState.currentTime >= 17.5 ? 'bg-gradient-sunset' : 'bg-gradient-bank'}">
                    <div class="absolute inset-0">
                        <!-- Î≤ΩÏãúÍ≥Ñ -->
                        <div class="${uiState.isMobile ? 'absolute top-2 left-2' : 'absolute top-4 left-4'}">
                            <div id="clock-border" class="bg-white rounded-full border-4 border-yellow-600 shadow-xl transition-all duration-500" style="width: ${uiState.isMobile ? '60px' : '80px'}; height: ${uiState.isMobile ? '60px' : '80px'}">
                                <div class="relative w-full h-full rounded-full bg-white">
                                    <div class="absolute top-1 left-1/2 transform -translate-x-1/2 text-xs font-bold text-gray-800">12</div>
                                    <div class="absolute top-1/2 right-1 transform -translate-y-1/2 text-xs font-bold text-gray-800">3</div>
                                    <div class="absolute bottom-1 left-1/2 transform -translate-x-1/2 text-xs font-bold text-gray-800">6</div>
                                    <div class="absolute top-1/2 left-1 transform -translate-y-1/2 text-xs font-bold text-gray-800">9</div>
                                    
                                    <div class="absolute top-1/2 left-1/2 w-2 h-2 bg-black rounded-full transform -translate-x-1/2 -translate-y-1/2 z-30"></div>
                                    
                                    <div id="hour-hand" class="absolute top-1/2 left-1/2 rounded-full origin-bottom z-20 transition-all duration-1000 bg-black" style="width: 2px; height: 15px; transform: translate(-50%, -100%) rotate(0deg); transform-origin: bottom center;"></div>
                                    <div id="minute-hand" class="absolute top-1/2 left-1/2 rounded-full origin-bottom z-10 transition-all duration-1000 bg-gray-700" style="width: 1px; height: 20px; transform: translate(-50%, -100%) rotate(0deg); transform-origin: bottom center;"></div>
                                </div>
                            </div>
                            <div id="clock-time-display" class="mt-1 text-center px-2 py-1 rounded font-mono font-bold text-xs bg-gray-800 text-green-400">
                                ${formatTime(gameState.currentTime)}
                            </div>
                        </div>
                        
                        <div class="absolute bottom-0 w-full ${uiState.isMobile ? 'h-8' : 'h-12'} bg-gray-400 border-t-4 border-gray-500"></div>
                        
                        <!-- Ï∞ΩÍµ¨ -->
                        <div class="absolute ${uiState.isMobile ? 'bottom-6' : 'bottom-12'} left-1/2 transform -translate-x-1/2 flex ${uiState.isMobile ? 'gap-3' : 'gap-6'}">
                            ${[0, 1, 2].map(i => `
                                <div class="relative">
                                    <div class="${uiState.isMobile ? 'w-12 h-8' : 'w-16 h-10'} bg-yellow-800 border-2 border-yellow-900 rounded-t-lg"></div>
                                    
                                    <div id="teller-${i}" class="absolute ${uiState.isMobile ? '-top-4' : '-top-6'} left-1/2 transform -translate-x-1/2 transition-all duration-500">
                                        <div class="${uiState.isMobile ? 'text-sm' : 'text-lg'}">üë®‚Äçüíº</div>
                                    </div>
                                    
                                    <div class="absolute ${uiState.isMobile ? '-bottom-3' : '-bottom-4'} left-1/2 transform -translate-x-1/2 bg-blue-600 text-white px-1 py-1 rounded text-xs font-bold">
                                        ${i + 1}Î≤à
                                    </div>
                                </div>
                            `).join('')}
                        </div>

                        <!-- Í≥†Í∞ùÎì§ -->
                        <div id="customer-area" class="absolute ${uiState.isMobile ? 'bottom-3' : 'bottom-5'} left-0 w-full h-6">
                        </div>

                        <!-- ÏùÄÌñâ Í∞ÑÌåê -->
                        <div class="absolute ${uiState.isMobile ? 'top-1 left-1/2' : 'top-2 left-1/2'} transform -translate-x-1/2">
                            <div class="bg-blue-800 text-white rounded-lg border-4 border-blue-600 ${uiState.isMobile ? 'px-3 py-1' : 'px-6 py-2'}">
                                <h2 class="${uiState.isMobile ? 'text-sm' : 'text-lg'} font-bold text-center">${gameState.bankName} ÏùÄÌñâ</h2>
                                <div class="text-center ${uiState.isMobile ? 'text-xs' : 'text-sm'} text-blue-200">
                                    ÏòÅÏóÖÏãúÍ∞Ñ: 09:00 - 18:00
                                </div>
                            </div>
                        </div>

                        <!-- Í∏àÎ¶¨ ÏïàÎÇ¥Ìåê -->
                        <div class="absolute ${uiState.isMobile ? 'top-12 right-1' : 'top-16 right-2'} bg-white border-2 border-gray-300 rounded-lg shadow-lg ${uiState.isMobile ? 'p-2' : 'p-3'}">
                            <h3 class="font-bold text-gray-800 mb-1 ${uiState.isMobile ? 'text-xs' : 'text-sm'}">üí∞ Í∏àÎ¶¨ ÏïàÎÇ¥</h3>
                            <div class="${uiState.isMobile ? 'text-xs' : 'text-sm'}">
                                <div class="flex justify-between">
                                    <span>ÏòàÍ∏à:</span>
                                    <span class="font-bold text-blue-600">${gameState.depositRate}%</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>ÎåÄÏ∂ú:</span>
                                    <span class="font-bold text-green-600">${gameState.loanRate}%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ÏùÄÌñâ Í≤ΩÏòÅ Ï†ïÎ≥¥ ÎåÄÏãúÎ≥¥Îìú -->
                <div class="${uiState.isMobile ? 'p-3' : 'p-6'} bg-white">
                    <!-- ÌïµÏã¨ ÏßÄÌëú -->
                    <div class="mb-6">
                        <h3 class="${uiState.isMobile ? 'text-base' : 'text-lg'} font-bold text-gray-800 mb-3">üìä ÏùÄÌñâ Í≤ΩÏòÅ ÌòÑÌô©</h3>
                        
                        <!-- ÏûêÏÇ∞/Î∂ÄÏ±Ñ ÌòÑÌô© -->
                        <div class="grid ${uiState.isMobile ? 'grid-cols-1 gap-3' : 'grid-cols-3 gap-4'} mb-4">
                            <div class="bg-blue-100 p-3 rounded-lg">
                                <div class="text-blue-800 font-bold ${uiState.isMobile ? 'text-sm' : 'text-base'}">üí∞ ÏòàÍ∏à Î∂ÄÎ¨∏ (ÏàòÏã†)</div>
                                <div class="space-y-1 text-sm">
                                    <div class="flex justify-between">
                                        <span>Í≥†Í∞ù Ïàò:</span>
                                        <span class="font-bold text-blue-600">${gameState.depositCustomers}Î™Ö</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Ï¥ù ÏòàÍ∏à:</span>
                                        <span class="font-bold text-blue-600">${formatCurrency(gameState.totalDepositBalance)}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Ïö¥Ïö©ÏàòÏùµÎ•†:</span>
                                        <span class="font-bold text-green-600">${gameState.assetYield}%</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="bg-green-100 p-3 rounded-lg">
                                <div class="text-green-800 font-bold ${uiState.isMobile ? 'text-sm' : 'text-base'}">üí∏ ÎåÄÏ∂ú Î∂ÄÎ¨∏ (Ïó¨Ïã†)</div>
                                <div class="space-y-1 text-sm">
                                    <div class="flex justify-between">
                                        <span>Í≥†Í∞ù Ïàò:</span>
                                        <span class="font-bold text-green-600">${gameState.loanCustomers}Î™Ö</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Ï¥ù ÎåÄÏ∂ú:</span>
                                        <span class="font-bold text-green-600">${formatCurrency(gameState.totalLoanBalance)}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Ïó∞Ï≤¥Ïú®:</span>
                                        <span class="font-bold text-red-600">${(gameState.defaultRate * 100).toFixed(2)}%</span>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-yellow-100 p-3 rounded-lg">
                                <div class="text-yellow-800 font-bold ${uiState.isMobile ? 'text-sm' : 'text-base'}">üè¶ ÏûêÎ≥∏ ÌòÑÌô©</div>
                                <div class="space-y-1 text-sm">
                                    <div class="flex justify-between">
                                        <span>Í∞ÄÏö© ÏûêÎ≥∏Í∏à:</span>
                                        <span class="font-bold text-yellow-600">${formatCurrency(gameState.currentCapital)}</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Ï¥ù ÏàòÏùµ:</span>
                                        <span class="font-bold ${gameState.totalProfit >= 0 ? 'text-green-600' : 'text-red-600'}">
                                            ${formatCurrency(gameState.totalProfit)}
                                        </span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Ïù¥Ïûê ÎßàÏßÑ:</span>
                                        <span class="font-bold text-blue-600">${(gameState.loanRate - gameState.depositRate).toFixed(1)}%p</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        ${gameState.currentCapital < gameState.initialCapital * 0.1 ? `
                            <div class="alert alert-danger mb-4">
                                <div class="flex items-center">
                                    <span class="mr-2">‚ö†Ô∏è</span>
                                    <p class="font-bold">ÏûêÎ≥∏Í∏à Î∂ÄÏ°± Í≤ΩÍ≥†! ÎåÄÏ∂ú Ïã§ÌñâÏù¥ Ï†úÌïúÎê† Ïàò ÏûàÏäµÎãàÎã§.</p>
                                </div>
                            </div>
                        ` : ''}
                    </div>

                    ${uiState.marketReactions.length > 0 ? `
                        <div class="mb-4">
                            <h3 class="${uiState.isMobile ? 'text-base' : 'text-lg'} font-bold text-gray-800 mb-3">üí¨ Í≥†Í∞ù Î∞òÏùë</h3>
                            <div class="${uiState.isMobile ? 'space-y-2' : 'flex gap-3 overflow-x-auto pb-2'}">
                                ${uiState.marketReactions.map(reaction => `
                                    <div class="${uiState.isMobile ? 'w-full' : 'flex-shrink-0'} p-3 rounded-lg border-l-4 ${
                                        reaction.type === 'positive' ? 'bg-green-50 border-green-400' :
                                        reaction.type === 'negative' ? 'bg-red-50 border-red-400' :
                                        'bg-blue-50 border-blue-400'
                                    }">
                                        <div class="flex items-center">
                                            <span class="${uiState.isMobile ? 'text-base' : 'text-lg'} mr-2">${reaction.icon}</span>
                                            <p class="text-sm font-medium">${reaction.message}</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    ` : ''}

                    ${uiState.currentEvent ? `
                        <div class="alert alert-warning mb-4">
                            <div class="flex items-center">
                                <span class="mr-2">‚ö†Ô∏è</span>
                                <div>
                                    <h3 class="text-lg font-medium">üì∞ ${uiState.currentEvent.name}</h3>
                                    <p>${uiState.currentEvent.effect}</p>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                </div>
            </div>
        `;
    }

    // ÌïòÎ£® ÎßàÍ∞ê ÌåùÏóÖ Î†åÎçîÎßÅ
    function renderDayEndPopup() {
        return `
            <div class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4 safe-area-top safe-area-bottom">
                <div class="bg-blue-900 border-4 border-blue-400 rounded-lg p-6 ${uiState.isMobile ? 'w-full max-w-sm' : 'max-w-lg'} mx-4 max-h-screen overflow-y-auto">
                    <div class="text-center mb-6">
                        <h3 class="${uiState.isMobile ? 'text-xl' : 'text-2xl'} font-bold text-white mb-2">üåô ÏòÅÏóÖ ÎßàÍ∞ê</h3>
                        <p class="text-blue-200 ${uiState.isMobile ? 'text-sm' : ''}">Ïò§Îäò ÌïòÎ£®ÎèÑ ÏàòÍ≥†ÌïòÏÖ®ÏäµÎãàÎã§. ÎÇ¥Ïùº ÏòÅÏóÖÏùÑ Ï§ÄÎπÑÌï¥Ï£ºÏÑ∏Ïöî.</p>
                    </div>

                    ${uiState.dayResults ? `
                        <div class="bg-blue-800 p-4 rounded-lg mb-6">
                            <h4 class="text-blue-200 font-bold mb-3">üìä Ïò§ÎäòÏùò ÏòÅÏóÖ Í≤∞Í≥º</h4>
                            <div class="space-y-2 text-sm text-blue-100">
                                <div class="grid grid-cols-2 gap-2">
                                    <div>üì• ÏòàÍ∏à: ${Math.round(uiState.dayResults.depositCustomers)}Î™Ö</div>
                                    <div>üì§ ÎåÄÏ∂ú: ${Math.round(uiState.dayResults.loanCustomers)}Î™Ö</div>
                                </div>
                                <div class="border-t border-blue-600 pt-2">
                                    <div class="text-green-300">üí∞ ÏàòÏùµ: ${formatCurrency(uiState.dayResults.assetOperationIncome + uiState.dayResults.loanInterestIncome)}</div>
                                    <div class="text-red-300">üí∏ ÎπÑÏö©: ${formatCurrency(uiState.dayResults.depositInterestCost + uiState.dayResults.defaultLoss + uiState.dayResults.operatingCost)}</div>
                                    <div class="font-bold ${uiState.dayResults.netIncome >= 0 ? 'text-green-300' : 'text-red-300'}">
                                        üìà ÏàúÏù¥Ïùµ: ${formatCurrency(uiState.dayResults.netIncome)}
                                    </div>
                                </div>
                                ${uiState.dayResults.capitalShortage ? `
                                    <div class="text-yellow-300 text-xs mt-2">
                                        ‚ö†Ô∏è ÏûêÎ≥∏Í∏à Î∂ÄÏ°±ÏúºÎ°ú ÎåÄÏ∂ú Ï†úÌïú Î∞úÏÉù
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div class="space-y-4 mb-6">
                        ${createSlider('deposit-rate-slider', 'üí∞ ÏàòÏã† Ïù¥ÏûêÏú®', gameState.depositRate, 1, 5, 0.1, '%', 'blue', 'depositRate', 'ÏãúÏû• ÌèâÍ∑†: 2.8% | ÎÜíÏùÑÏàòÎ°ù ÏòàÍ∏à Í≥†Í∞ù ‚Üë, Ïù¥Ïûê ÎπÑÏö© ‚Üë')}
                        ${createSlider('loan-rate-slider', 'üí∏ Ïó¨Ïã† Ïù¥ÏûêÏú®', gameState.loanRate, 3, 10, 0.1, '%', 'green', 'loanRate', 'ÏãúÏû• ÌèâÍ∑†: 5.2% | ÎÇÆÏùÑÏàòÎ°ù ÎåÄÏ∂ú Í≥†Í∞ù ‚Üë, ÏûêÎ≥∏Í∏à ÏÜåÎ™® ‚Üë')}
                        ${createSlider('advertising-slider', 'üì¢ Í¥ëÍ≥†ÎπÑ', gameState.advertising, 0, 5000000, 100000, 'Ïõê', 'purple', 'advertising', 'Í≥†Í∞ù Ïú†Ïπò Ìö®Í≥º ÏµúÎåÄ 3Î∞∞')}
                    </div>

                    <div class="flex justify-center">
                        <button
                            onclick="processDay()"
                            class="btn btn-primary ${uiState.isMobile ? 'w-full py-4 px-6 text-lg' : 'py-4 px-8 text-lg'}"
                        >
                            üåÖ Îã§Ïùå ÎÇ† ÏòÅÏóÖ ÏãúÏûë
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    // ÏûÖÎ†• Î™®Îã¨ Î†åÎçîÎßÅ
    function renderInputModal() {
        return `
            <div class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4 safe-area-top safe-area-bottom">
                <div class="bg-white rounded-lg shadow-xl ${uiState.isMobile ? 'w-full max-w-sm' : 'max-w-md'} mx-4">
                    <div class="p-6">
                        <h3 class="${uiState.isMobile ? 'text-lg' : 'text-xl'} font-bold text-gray-800 mb-4">
                            ${uiState.inputLabel} ÏßÅÏ†ë ÏûÖÎ†•
                        </h3>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                ÏÉàÎ°úÏö¥ Í∞íÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî
                            </label>
                            <input
                                type="number"
                                id="modal-input"
                                value="${uiState.inputValue}"
                                onchange="uiState.inputValue = this.value"
                                onkeypress="if(event.key === 'Enter') applyInputValue(); if(event.key === 'Escape') closeInputModal();"
                                class="input ${uiState.isMobile ? 'text-lg' : 'text-base'}"
                                placeholder="Ïà´ÏûêÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî"
                            />
                            <div class="text-xs text-gray-500 mt-1">
                                ${uiState.inputType === 'depositRate' ? 'Î≤îÏúÑ: 1.0% ~ 5.0%' : ''}
                                ${uiState.inputType === 'loanRate' ? 'Î≤îÏúÑ: 3.0% ~ 10.0%' : ''}
                                ${uiState.inputType === 'advertising' ? 'Î≤îÏúÑ: 0Ïõê ~ 500ÎßåÏõê' : ''}
                            </div>
                        </div>

                        <div class="flex gap-3">
                            <button
                                onclick="closeInputModal()"
                                class="btn btn-secondary flex-1 ${uiState.isMobile ? 'text-base' : 'text-sm'}"
                            >
                                Ï∑®ÏÜå
                            </button>
                            <button
                                onclick="applyInputValue()"
                                class="btn btn-primary flex-1 ${uiState.isMobile ? 'text-base' : 'text-sm'}"
                            >
                                Ï†ÅÏö©
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    // Ï¥àÍ∏∞Ìôî
    function init() {
        checkMobile();
        
        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
        window.addEventListener('resize', () => {
            checkMobile();
            render();
        });
        
        window.addEventListener('orientationchange', () => {
            setTimeout(() => {
                checkMobile();
                render();
            }, 500);
        });

        // ÌÑ∞Ïπò Ïù¥Î≤§Ìä∏ Î∞©ÏßÄ
        document.addEventListener('touchstart', (e) => {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        document.addEventListener('touchmove', (e) => {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        // Ï¥àÍ∏∞ Î†åÎçîÎßÅ
        render();
    }

    // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
    document.addEventListener('DOMContentLoaded', init);
</script>
```

</body>
</html>